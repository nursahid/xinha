Xinha.Config.prototype.TableOperations={showButtons:true};function TableOperations(e){this.editor=e;var a=e.config;var h=TableOperations.btnList;var b=this;a.removeToolbarElement(" inserttable toggleborders ");var f=["linebreak","inserttable","toggleborders"];for(var d=0;d<h.length;++d){var c=h[d];if(!c){if(a.TableOperations.showButtons){f.push("separator")}}else{var g="TO-"+c[0];a.registerButton(g,Xinha._lc(c[2],"TableOperations"),e.imgURL(c[0]+".gif","TableOperations"),false,function(i,j){b.buttonPress(i,j)},c[1]);if(a.TableOperations.showButtons){f.push(g)}}}a.toolbar.push(f);if(typeof PopupWin=="undefined"){Xinha._loadback(_editor_url+"modules/Dialogs/popupwin.js")}}TableOperations._pluginInfo={name:"TableOperations",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"Mihai Bazon",sponsor:"Zapatec Inc.",sponsor_url:"http://www.bloki.com",license:"htmlArea"};TableOperations.prototype._lc=function(a){return Xinha._lc(a,"TableOperations")};TableOperations.prototype.getClosest=function(c){var f=this.editor;var e=f.getAllAncestors();var a=null;c=(""+c).toLowerCase();for(var b=0;b<e.length;++b){var d=e[b];if(d.tagName.toLowerCase()==c){a=d;break}}return a};TableOperations.prototype.dialogTableProperties=function(){var b=this.getClosest("table");var a=new PopupWin(this.editor,Xinha._lc("Table Properties","TableOperations"),function(e,h){TableOperations.processStyle(h,b);for(var d in h){if(typeof h[d]=="function"){continue}var g=h[d];switch(d){case"f_caption":if(/\S/.test(g)){var c=b.getElementsByTagName("caption")[0];if(!c){c=e.editor._doc.createElement("caption");b.insertBefore(c,b.firstChild)}c.innerHTML=g}else{var c=b.getElementsByTagName("caption")[0];if(c){c.parentNode.removeChild(c)}}break;case"f_summary":b.summary=g;break;case"f_width":b.style.width=(""+g)+h.f_unit;break;case"f_align":b.align=g;break;case"f_spacing":b.cellSpacing=g;break;case"f_padding":b.cellPadding=g;break;case"f_borders":b.border=g;break;case"f_frames":b.frame=g;break;case"f_rules":b.rules=g;break}}e.editor.forceRedraw();e.editor.focusEditor();e.editor.updateToolbar();var f=b.style.borderCollapse;b.style.borderCollapse="collapse";b.style.borderCollapse="separate";b.style.borderCollapse=f},function(l){var s="";var h=b.getElementsByTagName("caption")[0];if(h){s=h.innerHTML}var k=b.summary;var i=parseInt(b.style.width);isNaN(i)&&(i="");var q=/%/.test(b.style.width)?"percent":"pixels";var d=b.align;var m=b.cellSpacing;var n=b.cellPadding;var j=b.border;var o=b.frame;var g=b.rules;function f(p){return p?" selected":""}l.content.style.width="400px";l.content.innerHTML=" <div class='title'>"+Xinha._lc("Table Properties","TableOperations")+"</div> <table style='width:100%'>   <tr>     <td>       <fieldset><legend>"+Xinha._lc("Description","TableOperations")+"</legend>        <table style='width:100%'>         <tr>           <td class='label'>"+Xinha._lc("Caption","TableOperations")+":</td>           <td class='value'><input type='text' name='f_caption' value='"+s+"'/></td>         </tr><tr>           <td class='label'>"+Xinha._lc("Summary","TableOperations")+":</td>           <td class='value'><input type='text' name='f_summary' value='"+k+"'/></td>         </tr>        </table>       </fieldset>     </td>   </tr>   <tr><td id='--HA-layout'></td></tr>   <tr>     <td>       <fieldset><legend>"+Xinha._lc("Spacing and padding","TableOperations")+"</legend>        <table style='width:100%'>         <tr>           <td class='label'>"+Xinha._lc("Spacing","TableOperations")+":</td>           <td><input type='text' name='f_spacing' size='5' value='"+m+"' /> &nbsp;"+Xinha._lc("Padding","TableOperations")+":            <input type='text' name='f_padding' size='5' value='"+n+"' /> &nbsp;&nbsp;"+Xinha._lc("pixels","TableOperations")+"          </td>         </tr>        </table>       </fieldset>     </td>   </tr>   <tr>     <td>       <fieldset><legend>"+Xinha._lc("Frame and borders","TableOperations")+"</legend>         <table width='100%'>           <tr>             <td class='label'>"+Xinha._lc("Borders","TableOperations")+":</td>             <td><input name='f_borders' type='text' size='5' value='"+j+"' /> &nbsp;&nbsp;"+Xinha._lc("pixels","TableOperations")+"</td>           </tr>           <tr>             <td class='label'>"+Xinha._lc("Frames","TableOperations")+":</td>             <td>               <select name='f_frames'>                 <option value='void'"+f(o=="void")+">"+Xinha._lc("No sides","TableOperations")+"</option>                 <option value='above'"+f(o=="above")+">"+Xinha._lc("The top side only","TableOperations")+"</option>                 <option value='below'"+f(o=="below")+">"+Xinha._lc("The bottom side only","TableOperations")+"</option>                 <option value='hsides'"+f(o=="hsides")+">"+Xinha._lc("The top and bottom sides only","TableOperations")+"</option>                 <option value='vsides'"+f(o=="vsides")+">"+Xinha._lc("The right and left sides only","TableOperations")+"</option>                 <option value='lhs'"+f(o=="lhs")+">"+Xinha._lc("The left-hand side only","TableOperations")+"</option>                 <option value='rhs'"+f(o=="rhs")+">"+Xinha._lc("The right-hand side only","TableOperations")+"</option>                 <option value='box'"+f(o=="box")+">"+Xinha._lc("All four sides","TableOperations")+"</option>               </select>             </td>           </tr>           <tr>             <td class='label'>"+Xinha._lc("Rules","TableOperations")+":</td>             <td>               <select name='f_rules'>                 <option value='none'"+f(g=="none")+">"+Xinha._lc("No rules","TableOperations")+"</option>                 <option value='rows'"+f(g=="rows")+">"+Xinha._lc("Rules will appear between rows only","TableOperations")+"</option>                 <option value='cols'"+f(g=="cols")+">"+Xinha._lc("Rules will appear between columns only","TableOperations")+"</option>                 <option value='all'"+f(g=="all")+">"+Xinha._lc("Rules will appear between all rows and columns","TableOperations")+"</option>               </select>             </td>           </tr>         </table>       </fieldset>     </td>   </tr>   <tr>     <td id='--HA-style'></td>   </tr> </table> ";var r=TableOperations.createStyleFieldset(l.doc,l.editor,b);var e=l.doc.getElementById("--HA-style");e.appendChild(r);var c=TableOperations.createStyleLayoutFieldset(l.doc,l.editor,b);e=l.doc.getElementById("--HA-layout");e.appendChild(c);l.modal=true;l.addButtons("OK","Cancel");l.showAtElement(l.editor._iframe,"c")})};TableOperations.prototype.dialogRowCellProperties=function(a){var c=this.getClosest(a?"td":"tr");var d=this.getClosest("table");var b=new PopupWin(this.editor,a?Xinha._lc("Cell Properties","TableOperations"):Xinha._lc("Row Properties","TableOperations"),function(f,j){TableOperations.processStyle(j,c);for(var e in j){if(typeof j[e]=="function"){continue}var h=j[e];switch(e){case"f_align":c.align=h;break;case"f_char":c.ch=h;break;case"f_valign":c.vAlign=h;break}}f.editor.forceRedraw();f.editor.focusEditor();f.editor.updateToolbar();var g=d.style.borderCollapse;d.style.borderCollapse="collapse";d.style.borderCollapse="separate";d.style.borderCollapse=g},function(h){var j=c.align;var g=c.vAlign;var f=c.ch;function i(m){return m?" selected":""}h.content.style.width="400px";h.content.innerHTML=" <div class='title'>"+Xinha._lc(a?"Cell Properties":"Row Properties","TableOperations")+"</div> <table style='width:100%'>   <tr>     <td id='--HA-layout'>     </td>   </tr>   <tr>     <td id='--HA-style'></td>   </tr> </table> ";var e=TableOperations.createStyleFieldset(h.doc,h.editor,c);var k=h.doc.getElementById("--HA-style");k.appendChild(e);var l=TableOperations.createStyleLayoutFieldset(h.doc,h.editor,c);k=h.doc.getElementById("--HA-layout");k.appendChild(l);h.modal=true;h.addButtons("OK","Cancel");h.showAtElement(h.editor._iframe,"c")})};TableOperations.prototype.buttonPress=function(e,k){this.editor=e;var f=Xinha.is_gecko?"<br />":"";function g(I){var H=I.getElementsByTagName("td");for(var G=H.length;--G>=0;){var J=H[G];J.rowSpan=1;J.innerHTML=f}}function y(L){var K=parseInt(""+L.rowSpan);var J=parseInt(""+L.colSpan);L.rowSpan=1;a=L.parentNode;var H=a.rowIndex;var i=a.parentNode.rows;var G=L.cellIndex;while(--K>0){a=i[++H];var I=e._doc.createElement("td");I.colSpan=L.colSpan;I.innerHTML=f;a.insertBefore(I,a.cells[G])}e.forceRedraw();e.updateToolbar()}function s(I){var H=parseInt(""+I.colSpan);I.colSpan=1;a=I.parentNode;var G=I.nextSibling;while(--H>0){var i=e._doc.createElement("td");i.rowSpan=I.rowSpan;i.innerHTML=f;a.insertBefore(i,G)}e.forceRedraw();e.updateToolbar()}function F(I){var H=parseInt(""+I.colSpan);s(I);var i=I.parentNode.cells;var G=I.cellIndex;while(H-->0){y(i[G++])}}function z(i){var G=i.nextSibling;while(G&&G.nodeType!=1){G=G.nextSibling}if(!G){G=i.previousSibling;while(G&&G.nodeType!=1){G=G.previousSibling}}if(!G){G=i.parentNode}e.selectNodeContents(G)}function l(S,H,O,G,J){var V=[];var T=[];try{for(C=O;C<O+J;C++){var U=S.rows[C];for(K=H;K<H+G;K++){if(U.cells[K].colSpan>1||U.cells[K].rowSpan>1){F(U.cells[K])}T.push(U.cells[K])}if(T.length>0){V.push(T);T=[]}}}catch(N){alert("Invalid selection");return false}var Q=V[0][0].parentNode.rowIndex;var P=V[V.length-1][0].parentNode.rowIndex;var M=V[V.length-1][0].rowSpan;var L="";for(C=0;C<V.length;++C){var T=V[C];for(var K=0;K<T.length;++K){var R=T[K];L+=R.innerHTML;(C||K)&&(R.parentNode.removeChild(R))}}var I=V[0][0];I.innerHTML=L;I.rowSpan=P-Q+M;var i=0;for(K=0;K<V[0].length;K++){i+=V[0][K].colSpan}I.colSpan=i;e.selectNodeContents(I);e.forceRedraw();e.focusEditor()}switch(k){case"TO-row-insert-above":case"TO-row-insert-under":var a=this.getClosest("tr");if(!a){break}var q=a.cloneNode(true);g(q);a.parentNode.insertBefore(q,/under/.test(k)?a.nextSibling:a);e.forceRedraw();e.focusEditor();break;case"TO-row-delete":var a=this.getClosest("tr");if(!a){break}var u=a.parentNode;if(u.rows.length==1){alert(Xinha._lc("Xinha cowardly refuses to delete the last row in table.","TableOperations"));break}z(a);u.removeChild(a);e.forceRedraw();e.focusEditor();e.updateToolbar();break;case"TO-row-split":var m=this.getClosest("td");if(!m){break}y(m);break;case"TO-col-insert-before":case"TO-col-insert-after":var m=this.getClosest("td");if(!m){break}var p=m.parentNode.parentNode.rows;var j=m.cellIndex;var n=(m.parentNode.cells.length==j+1);for(var C=p.length;--C>=0;){var a=p[C];var B=e._doc.createElement("td");B.innerHTML=f;if(n&&Xinha.is_ie){a.insertBefore(B)}else{var h=a.cells[j+(/after/.test(k)?1:0)];a.insertBefore(B,h)}}e.focusEditor();break;case"TO-col-split":var m=this.getClosest("td");if(!m){break}s(m);break;case"TO-col-delete":var m=this.getClosest("td");if(!m){break}var j=m.cellIndex;if(m.parentNode.cells.length==1){alert(Xinha._lc("Xinha cowardly refuses to delete the last column in table.","TableOperations"));break}z(m);var p=m.parentNode.parentNode.rows;for(var C=p.length;--C>=0;){var a=p[C];a.removeChild(a.cells[j])}e.forceRedraw();e.focusEditor();e.updateToolbar();break;case"TO-cell-split":var m=this.getClosest("td");if(!m){break}F(m);break;case"TO-cell-insert-before":case"TO-cell-insert-after":var m=this.getClosest("td");if(!m){break}var a=m.parentNode;var B=e._doc.createElement("td");B.innerHTML=f;a.insertBefore(B,/after/.test(k)?m.nextSibling:m);e.forceRedraw();e.focusEditor();break;case"TO-cell-delete":var m=this.getClosest("td");if(!m){break}if(m.parentNode.cells.length==1){alert(Xinha._lc("Xinha cowardly refuses to delete the last cell in row.","TableOperations"));break}z(m);m.parentNode.removeChild(m);e.forceRedraw();e.updateToolbar();break;case"TO-cell-merge":var A=e._getSelection();if(!Xinha.is_ie&&A.rangeCount>1){var t=A.getRangeAt(0);var m=t.startContainer.childNodes[t.startOffset];var a=m.parentNode;var o=m.cellIndex;var r=a.rowIndex;var x=0;var w=r;var c=0;var v=0;var d,E;for(C=0;C<A.rangeCount;C++){t=A.getRangeAt(C);d=t.startContainer.childNodes[t.startOffset];E=d.parentNode;if(E.rowIndex!=w){w=E.rowIndex;v=0}v+=d.colSpan;if(v>c){c=v}if(E.rowIndex+d.rowSpan-1>x){x=E.rowIndex+d.rowSpan-1}}var b=x-r+1;var D=a.parentNode;l(D,o,r,c,b)}else{var m=this.getClosest("td");if(!m){alert(Xinha._lc("Please click into some cell","TableOperations"));break}e._popupDialog("plugin://TableOperations/merge_cells.html",function(I){if(!I){return false}c=parseInt(I.f_cols,10)+1;b=parseInt(I.f_rows,10)+1;var H=m.parentNode;var J=m.cellIndex;var i=H.rowIndex;var G=H.parentNode;l(G,J,i,c,b)},null)}break;case"TO-table-prop":this.dialogTableProperties();break;case"TO-row-prop":this.dialogRowCellProperties(false);break;case"TO-cell-prop":this.dialogRowCellProperties(true);break;default:alert("Button ["+k+"] not yet implemented")}};TableOperations.btnList=[["table-prop","table","Table properties"],null,["row-prop","tr","Row properties"],["row-insert-above","tr","Insert row before"],["row-insert-under","tr","Insert row after"],["row-delete","tr","Delete row"],["row-split","td[rowSpan!=1]","Split row"],null,["col-insert-before","td","Insert column before"],["col-insert-after","td","Insert column after"],["col-delete","td","Delete column"],["col-split","td[colSpan!=1]","Split column"],null,["cell-prop","td","Cell properties"],["cell-insert-before","td","Insert cell before"],["cell-insert-after","td","Insert cell after"],["cell-delete","td","Delete cell"],["cell-merge","tr","Merge cells"],["cell-split","td[colSpan!=1,rowSpan!=1]","Split cell"]];TableOperations.getLength=function(b){var a=parseInt(b);if(isNaN(a)){a=""}return a};TableOperations.processStyle=function(f,b){var d=b.style;for(var a in f){if(typeof f[a]=="function"){continue}var e=f[a];switch(a){case"f_st_backgroundColor":d.backgroundColor=e;break;case"f_st_color":d.color=e;break;case"f_st_backgroundImage":if(/\S/.test(e)){d.backgroundImage="url("+e+")"}else{d.backgroundImage="none"}break;case"f_st_borderWidth":d.borderWidth=e;break;case"f_st_borderStyle":d.borderStyle=e;break;case"f_st_borderColor":d.borderColor=e;break;case"f_st_borderCollapse":d.borderCollapse=e?"collapse":"";break;case"f_st_width":if(/\S/.test(e)){d.width=e+f.f_st_widthUnit}else{d.width=""}break;case"f_st_height":if(/\S/.test(e)){d.height=e+f.f_st_heightUnit}else{d.height=""}break;case"f_st_textAlign":if(e=="char"){var c=f.f_st_textAlignChar;if(c=='"'){c='\\"'}d.textAlign='"'+c+'"'}else{if(e=="-"){d.textAlign=""}else{d.textAlign=e}}break;case"f_st_verticalAlign":b.vAlign="";if(e=="-"){d.verticalAlign=""}else{d.verticalAlign=e}break;case"f_st_float":d.cssFloat=e;break}}};TableOperations.createColorButton=function(h,e,b,a){if(!b){b=""}else{if(!/#/.test(b)){b=Xinha._colorToRgb(b)}}var f=h.createElement("span");var g=h.createElement("input");g.type="hidden";f.appendChild(g);g.name="f_st_"+a;g.value=b;var d=h.createElement("span");d.className="buttonColor";f.appendChild(d);var i=h.createElement("span");i.className="chooser";i.style.backgroundColor=b;d.appendChild(i);d.onmouseover=function(){if(!this.disabled){this.className+=" buttonColor-hilite"}};d.onmouseout=function(){if(!this.disabled){this.className="buttonColor"}};i.onclick=function(){if(this.parentNode.disabled){return false}e._popupDialog("select_color.html",function(j){if(j){i.style.backgroundColor="#"+j;g.value="#"+j}},b)};var c=h.createElement("span");c.innerHTML="&#x00d7;";c.className="nocolor";c.title=Xinha._lc("Unset color","TableOperations");d.appendChild(c);c.onmouseover=function(){if(!this.parentNode.disabled){this.className+=" nocolor-hilite"}};c.onmouseout=function(){if(!this.parentNode.disabled){this.className="nocolor"}};c.onclick=function(){i.style.backgroundColor="";g.value=""};return f};TableOperations.createStyleLayoutFieldset=function(r,f,d){var l=r.createElement("fieldset");var c=r.createElement("legend");l.appendChild(c);c.innerHTML=Xinha._lc("Layout","TableOperations");var o=r.createElement("table");l.appendChild(o);o.style.width="100%";var a=r.createElement("tbody");o.appendChild(a);var p=d.tagName.toLowerCase();var b,h,j,m,k,e,n;if(p!="td"&&p!="tr"&&p!="th"){b=r.createElement("tr");a.appendChild(b);h=r.createElement("td");h.className="label";b.appendChild(h);h.innerHTML=Xinha._lc("Float","TableOperations")+":";h=r.createElement("td");b.appendChild(h);m=r.createElement("select");h.appendChild(m);m.name="f_st_float";e=["None","Left","Right"];for(var n=0;n<e.length;++n){var g=e[n];var s=e[n].toLowerCase();k=r.createElement("option");k.innerHTML=Xinha._lc(g,"TableOperations");k.value=s;k.selected=((""+d.style.cssFloat).toLowerCase()==s);m.appendChild(k)}}b=r.createElement("tr");a.appendChild(b);h=r.createElement("td");h.className="label";b.appendChild(h);h.innerHTML=Xinha._lc("Width","TableOperations")+":";h=r.createElement("td");b.appendChild(h);j=r.createElement("input");j.type="text";j.value=TableOperations.getLength(d.style.width);j.size="5";j.name="f_st_width";j.style.marginRight="0.5em";h.appendChild(j);m=r.createElement("select");m.name="f_st_widthUnit";k=r.createElement("option");k.innerHTML=Xinha._lc("percent","TableOperations");k.value="%";k.selected=/%/.test(d.style.width);m.appendChild(k);k=r.createElement("option");k.innerHTML=Xinha._lc("pixels","TableOperations");k.value="px";k.selected=/px/.test(d.style.width);m.appendChild(k);h.appendChild(m);m.style.marginRight="0.5em";h.appendChild(r.createTextNode(Xinha._lc("Text align","TableOperations")+":"));m=r.createElement("select");m.style.marginLeft=m.style.marginRight="0.5em";h.appendChild(m);m.name="f_st_textAlign";e=["Left","Center","Right","Justify","-"];if(p=="td"){e.push("Char")}j=r.createElement("input");j.name="f_st_textAlignChar";j.size="1";j.style.fontFamily="monospace";h.appendChild(j);for(var n=0;n<e.length;++n){var g=e[n];var s=g.toLowerCase();k=r.createElement("option");k.value=s;k.innerHTML=Xinha._lc(g,"TableOperations");k.selected=((d.style.textAlign.toLowerCase()==s)||(d.style.textAlign==""&&g=="-"));m.appendChild(k)}function q(i){j.style.visibility=i?"visible":"hidden";if(i){j.focus();j.select()}}m.onchange=function(){q(this.value=="char")};q(m.value=="char");b=r.createElement("tr");a.appendChild(b);h=r.createElement("td");h.className="label";b.appendChild(h);h.innerHTML=Xinha._lc("Height","TableOperations")+":";h=r.createElement("td");b.appendChild(h);j=r.createElement("input");j.type="text";j.value=TableOperations.getLength(d.style.height);j.size="5";j.name="f_st_height";j.style.marginRight="0.5em";h.appendChild(j);m=r.createElement("select");m.name="f_st_heightUnit";k=r.createElement("option");k.innerHTML=Xinha._lc("percent","TableOperations");k.value="%";k.selected=/%/.test(d.style.height);m.appendChild(k);k=r.createElement("option");k.innerHTML=Xinha._lc("pixels","TableOperations");k.value="px";k.selected=/px/.test(d.style.height);m.appendChild(k);h.appendChild(m);m.style.marginRight="0.5em";h.appendChild(r.createTextNode(Xinha._lc("Vertical align","TableOperations")+":"));m=r.createElement("select");m.name="f_st_verticalAlign";m.style.marginLeft="0.5em";h.appendChild(m);e=["Top","Middle","Bottom","Baseline","-"];for(var n=0;n<e.length;++n){var g=e[n];var s=g.toLowerCase();k=r.createElement("option");k.value=s;k.innerHTML=Xinha._lc(g,"TableOperations");k.selected=((d.style.verticalAlign.toLowerCase()==s)||(d.style.verticalAlign==""&&g=="-"));m.appendChild(k)}return l};TableOperations.createStyleFieldset=function(x,g,e){var p=x.createElement("fieldset");var d=x.createElement("legend");p.appendChild(d);d.innerHTML=Xinha._lc("CSS Style","TableOperations");var t=x.createElement("table");p.appendChild(t);t.style.width="100%";var b=x.createElement("tbody");t.appendChild(b);var c,h,m,q,n,f,s;c=x.createElement("tr");b.appendChild(c);h=x.createElement("td");c.appendChild(h);h.className="label";h.innerHTML=Xinha._lc("Background","TableOperations")+":";h=x.createElement("td");c.appendChild(h);var u=TableOperations.createColorButton(x,g,e.style.backgroundColor,"backgroundColor");u.firstChild.nextSibling.style.marginRight="0.5em";h.appendChild(u);h.appendChild(x.createTextNode(Xinha._lc("Image URL","TableOperations")+": "));m=x.createElement("input");m.type="text";m.name="f_st_backgroundImage";if(e.style.backgroundImage.match(/url\(\s*(.*?)\s*\)/)){m.value=RegExp.$1}h.appendChild(m);c=x.createElement("tr");b.appendChild(c);h=x.createElement("td");c.appendChild(h);h.className="label";h.innerHTML=Xinha._lc("FG Color","TableOperations")+":";h=x.createElement("td");c.appendChild(h);h.appendChild(TableOperations.createColorButton(x,g,e.style.color,"color"));m=x.createElement("input");m.style.visibility="hidden";m.type="text";h.appendChild(m);c=x.createElement("tr");b.appendChild(c);h=x.createElement("td");c.appendChild(h);h.className="label";h.innerHTML=Xinha._lc("Border","TableOperations")+":";h=x.createElement("td");c.appendChild(h);var w=TableOperations.createColorButton(x,g,e.style.borderColor,"borderColor");var j=w.firstChild.nextSibling;h.appendChild(w);j.style.marginRight="0.5em";q=x.createElement("select");var o=[];h.appendChild(q);q.name="f_st_borderStyle";f=["none","dotted","dashed","solid","double","groove","ridge","inset","outset"];var a=e.style.borderStyle;(a.match(/([^\s]*)\s/))&&(a=RegExp.$1);for(var s in f){if(typeof f[s]=="function"){continue}var v=f[s];n=x.createElement("option");n.value=v;n.innerHTML=v;(v==a)&&(n.selected=true);q.appendChild(n)}q.style.marginRight="0.5em";function l(A){for(var y=0;y<o.length;++y){var z=o[y];z.style.visibility=A?"hidden":"visible";if(!A&&(z.tagName.toLowerCase()=="input")){z.focus();z.select()}}}q.onchange=function(){l(this.value=="none")};m=x.createElement("input");o.push(m);m.type="text";m.name="f_st_borderWidth";m.value=TableOperations.getLength(e.style.borderWidth);m.size="5";h.appendChild(m);m.style.marginRight="0.5em";var r=x.createElement("span");r.innerHTML=Xinha._lc("pixels","TableOperations");h.appendChild(r);o.push(r);l(q.value=="none");if(e.tagName.toLowerCase()=="table"){c=x.createElement("tr");b.appendChild(c);h=x.createElement("td");h.className="label";c.appendChild(h);m=x.createElement("input");m.type="checkbox";m.name="f_st_borderCollapse";m.id="f_st_borderCollapse";var v=(/collapse/i.test(e.style.borderCollapse));m.checked=v?1:0;h.appendChild(m);h=x.createElement("td");c.appendChild(h);var k=x.createElement("label");k.htmlFor="f_st_borderCollapse";k.innerHTML=Xinha._lc("Collapsed borders","TableOperations");h.appendChild(k)}return p};