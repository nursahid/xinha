InsertImage._pluginInfo={name:"InsertImage",origin:"Xinha Core",version:"$LastChangedRevision: 900 $".replace(/^[^:]*: (.*) \$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL: http://svn.xinha.org/branches/0.95_stable/modules/InsertImage/insert_image.js $".replace(/^[^:]*: (.*) \$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};function InsertImage(a){}Xinha.prototype._insertImage=function(e){var b=this;var f;if(typeof e=="undefined"){e=this.getParentElement();if(e&&e.tagName.toLowerCase()!="img"){e=null}}var d;if(typeof b.config.baseHref!="undefined"&&b.config.baseHref!==null){d=b.config.baseHref}else{var c=window.location.toString().split("/");c.pop();d=c.join("/")}if(e){function a(j,k){var g=j.attributes;for(var h=0;h<g.length;h++){if(g[h].nodeName==k&&g[h].specified){return g[h].value}}return""}f={f_base:d,f_url:e.getAttribute("src",2),f_alt:e.alt,f_border:e.border,f_align:e.align,f_vert:a(e,"vspace"),f_horiz:a(e,"hspace"),f_width:e.width,f_height:e.height}}else{f={f_base:d,f_url:""}}Dialog(b.config.URIs.insert_image,function(l){if(!l){return false}var h=e;if(!h){if(Xinha.is_ie){var j=b.getSelection();var g=b.createRange(j);b._doc.execCommand("insertimage",false,l.f_url);h=g.parentElement();if(h.tagName.toLowerCase()!="img"){h=h.previousSibling}}else{h=document.createElement("img");h.src=l.f_url;b.insertNodeAtSelection(h);if(!h.tagName){h=g.startContainer.firstChild}}}else{h.src=l.f_url}for(var k in l){var i=l[k];switch(k){case"f_alt":if(i){h.alt=i}else{h.removeAttribute("alt")}break;case"f_border":if(i){h.border=parseInt(i||"0")}else{h.removeAttribute("border")}break;case"f_align":if(i){h.align=i}else{h.removeAttribute("align")}break;case"f_vert":if(i!=""){h.vspace=parseInt(i||"0")}else{h.removeAttribute("vspace")}break;case"f_horiz":if(i!=""){h.hspace=parseInt(i||"0")}else{h.removeAttribute("hspace")}break;case"f_width":if(i){h.width=parseInt(i||"0")}else{h.removeAttribute("width")}break;case"f_height":if(i){h.height=parseInt(i||"0")}else{h.removeAttribute("height")}break}}},f)};