InsertTable._pluginInfo={name:"InsertTable",origin:"Xinha Core",version:"$LastChangedRevision: 688 $".replace(/^[^:]*: (.*) \$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL: http://svn.xinha.python-hosting.com/trunk/modules/InsertTable/insert_table.js $".replace(/^[^:]*: (.*) \$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};function InsertTable(a){}Xinha.prototype._insertTable=function(){var c=this.getSelection();var a=this.createRange(c);var b=this;Dialog(b.config.URIs.insert_table,function(d){if(!d){return false}var n=b._doc;var p=n.createElement("table");for(var m in d){var o=d[m];if(!o){continue}switch(m){case"f_width":p.style.width=o+d.f_unit;break;case"f_align":p.align=o;break;case"f_border":p.border=parseInt(o,10);break;case"f_spacing":p.cellSpacing=parseInt(o,10);break;case"f_padding":p.cellPadding=parseInt(o,10);break}}var k=0;if(d.f_fixed){k=Math.floor(100/parseInt(d.f_cols,10))}var h=n.createElement("tbody");p.appendChild(h);for(var g=0;g<d.f_rows;++g){var l=n.createElement("tr");h.appendChild(l);for(var f=0;f<d.f_cols;++f){var e=n.createElement("td");if(k){e.style.width=k+"%"}l.appendChild(e);e.appendChild(n.createTextNode("\u00a0"))}}if(Xinha.is_ie){a.pasteHTML(p.outerHTML)}else{b.insertNodeAtSelection(p)}return true},null)};